(function(c){var d=function(f){return f.is(".processing")||f.parents(".processing").length};var e=function(f){if(!d(f)){f.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}})}};var b=function(f){f.removeClass("processing").unblock()};var a={__instance:undefined};a.Application=Backbone.View.extend({id:"wpmi_modal",events:{"click .media-modal-backdrop":"Close","click .media-modal-close":"Close","click .media-modal-delete":"Delete","click .media-modal-prev":"update","click .media-modal-next":"update","submit .media-modal-form":"Save"},templates:{},initialize:function(f){_.bindAll(this,"open","update","render","Close","Save");this.init();this.open(f)},init:function(){this.templates.window=wp.template("wpmi-modal-window")},render:function(g){var f=this;c.ajax({url:ajaxurl,data:{action:"qlwapp_edit_contact",nonce:qlwapp.nonce.qlwapp_edit_contact,contact_id:g},dataType:"json",type:"POST",beforeSend:function(){},complete:function(){},error:function(h){console.log(h)},success:function(h){f.$el.attr("tabindex","0");f.$el.html(f.templates.window(h.data));f.$el.focus().trigger("wc-init-tabbed-panels");f.$el.focus().trigger("init_tooltips")}})},update:function(h){h.stopPropagation();h.preventDefault();var g=c(h.target),f=g.data("contact_id");this.render(f)},open:function(i){var h=c(i.target),f=h.closest("tr"),g=f.data("contact_id");this.render(g);c("body").addClass("modal-open").append(this.$el)},Close:function(f){f.preventDefault();this.undelegateEvents();c(document).off("focusin");c("body").removeClass("modal-open");this.remove();a.__instance=undefined},Save:function(i){i.preventDefault();var f=c(i.target),g=this.$el,h=g.find(".settings-save-status .spinner");c.ajax({url:ajaxurl,data:{action:"qlwapp_save_contact",nonce:qlwapp.nonce.qlwapp_save_contact,contact_id:f.data("contact_id"),contact_data:f.serializeArrayAll()},dataType:"json",type:"POST",beforeSend:function(){h.addClass("is-active")},complete:function(){h.removeClass("is-active")},error:function(){alert("Error!")},success:function(j){g.find(".settings-save-status").addClass("save-complete");console.log(j)}});return false},Delete:function(g){g.preventDefault();var f=this;f.Close(g)}});c("#qlwapp_settings_add").on("click",function(f){f.preventDefault();if(a.__instance===undefined){a.__instance=new a.Application(f)}});c(".qlwapp_settings_edit").on("click",function(f){f.preventDefault();if(a.__instance===undefined){a.__instance=new a.Application(f)}});c(".qlwapp_settings_delete").on("click",function(f){alert("hacer algo ...");f.preventDefault()})})(jQuery);